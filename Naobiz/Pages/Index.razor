@page "/"

@inherits AuthorizedBase
@inject NavigationManager NavigationManager
@inject UserService UserService
@inject Settings Settings

<Heading Size="HeadingSize.Is1">Home</Heading>

<Row>
    @foreach (var item in Settings.Dashboard)
    {
        <Column ColumnSize="ColumnSize.IsQuarter">
            <Card Margin="Margin.Is4.OnY">
                <CardHeader>
                    <CardSubtitle>@item.Name</CardSubtitle>
                </CardHeader>
                <CardLink Source="@item.LinkUrl">
                    <CardImage Source="@item.ImageSource" />
                </CardLink>
            </Card>
        </Column>
    }
</Row>

@code {
    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        var user = await UserService.GetCurrentAsync(Service);
        if (user == null)
        {
            return;
        }

        if (!await Service.GetActivities(user).AnyAsync())
        {
            NavigationManager.NavigateTo("activities");
        }
    }
}
